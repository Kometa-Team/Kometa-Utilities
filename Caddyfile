anidb-service.kometa.wiki {
    # Authentication is handled by FastAPI - no duplicate auth layer needed
    
    # Handle errors (like when the backend is down)
    handle_errors {
        @maintenance expression {err.status_code} in [502, 503, 504]
        handle @maintenance {
            rewrite * /maintenance.html
            file_server {
                root /var/www/html
            }
        }
    }

    # Proxy to FastAPI backend
    reverse_proxy anidb-mirror:8000
}